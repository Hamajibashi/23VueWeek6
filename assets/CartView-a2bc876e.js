import{_ as w,r as g,o as r,c as i,e as I,d as x,T as q,a as e,F as v,f as V,h as U,t as c,b as n,w as y,g as F,i as j,j as f}from"./index-bd23fdf7.js";const h="https://vue3-course-api.hexschool.io",_="hmjbs",B={data(){return{cart:{carts:[]},loadingItem:"",form:{user:{name:"",email:"",tel:"",address:""},message:""}}},methods:{addLoading(){const o=this.$loading.show();setTimeout(()=>{o.hide()},800)},getCart(){const o=`${h}/v2/api/${_}/cart`;this.axios.get(o).then(t=>{this.cart=t.data.data}).catch(t=>{alert(t.data.message)})},updateItem(o){const t={product_id:o.id,qty:o.qty};this.loadingItem=o.id;const d=`${h}/v2/api/${_}/cart/${o.id}`;this.axios.put(d,{data:t}).then(p=>{alert(p.data.message),this.getCart(),this.loadingItem=""}).catch(p=>{alert(p.data.message)})},removeAll(){const o=`${h}/v2/api/${_}/carts`;this.axios.delete(o).then(t=>{alert(t.data.message),this.getCart()}).catch(t=>{alert(t.data.message)})},removeItem(o){this.loadingItem=o;const t=`${h}/v2/api/${_}/cart/${o}`;this.axios.delete(t).then(d=>{alert(d.data.message),this.getCart(),this.loadingItem=""}).catch(d=>{alert(d.response.data.message)})},createOrder(){const o=this.form,t=`${h}/v2/api/${_}/order`;this.axios.post(t,{data:o}).then(d=>{alert(d.data.message),this.$refs.form.resetForm(),this.getCart()}).catch(d=>{alert(d.response.data.message)})}},mounted(){this.addLoading(),this.getCart()}},N={class:"mt-4"},S=e("h1",{class:"h2 fw-bold mb-4 text-center"},"購物車",-1),T={class:"text-end"},A=["disabled"],E={key:0,class:"table align-middle"},L=e("thead",null,[e("tr",null,[e("th"),e("th"),e("th",null,"品名"),e("th",{style:{width:"150px"}},"數量/單位"),e("th",null,"單價"),e("th",{class:"text-end"},"總價")])],-1),D=["disabled","onClick"],O={width:"200px"},z=["src"],M={class:"input-group input-group-sm"},P={class:"input-group mb-3"},G=["onUpdate:modelValue","disabled","onChange"],H=["value"],J={class:"input-group-text",id:"basic-addon2"},K={class:"text-end"},Q=e("td",{colspan:"5",class:"text-end fw-bold"},"總計",-1),R={class:"text-end fw-bold fs-3"},W={key:1,class:"d-flex flex-column justify-content-center align-items-center"},X=e("h4",{class:"my-4"}," 購物車目前沒有商品哦！ ",-1),Y={class:"my-5 row justify-content-center"},Z={class:"mb-3"},$=e("label",{for:"email",class:"form-label"},"Email",-1),ee={class:"mb-3"},te=e("label",{for:"name",class:"form-label"},"收件人姓名",-1),se={class:"mb-3"},le=e("label",{for:"tel",class:"form-label"},"收件人電話",-1),ae={class:"mb-3"},oe=e("label",{for:"address",class:"form-label"},"收件人地址",-1),ne={class:"mb-3"},de=e("label",{for:"message",class:"form-label"},"留言",-1),re={class:"text-end"},ie=["disabled"];function ce(o,t,d,p,l,m){const k=g("router-link"),u=g("VeeField"),b=g("error-message"),C=g("VeeForm");return r(),i(v,null,[(r(),I(q,{to:"title"},[x(" | 購物車")])),e("div",N,[S,e("div",T,[e("button",{class:"btn btn-outline-danger mb-4",type:"button",disabled:l.cart.carts.length===0,onClick:t[0]||(t[0]=(...s)=>m.removeAll&&m.removeAll(...s))},"清空購物車",8,A)]),l.cart.carts.length!==0?(r(),i("table",E,[L,e("tbody",null,[l.cart.carts?(r(!0),i(v,{key:0},V(l.cart.carts,s=>(r(),i("tr",{key:s.id},[e("td",null,[e("button",{type:"button",class:"btn btn-outline-danger btn-sm",disabled:s.id===l.loadingItem,onClick:a=>m.removeItem(s.id)}," x ",8,D)]),e("td",O,[e("img",{src:s.product.imageUrl,alt:"產品圖片",class:"object-fit-cover",style:{height:"100px",width:"100px"}},null,8,z)]),e("td",null,c(s.product.title),1),e("td",null,[e("div",M,[e("div",P,[F(e("select",{name:"",class:"form-select","onUpdate:modelValue":a=>s.qty=a,disabled:s.id===l.loadingItem,onChange:a=>m.updateItem(s)},[(r(),i(v,null,V(10,a=>e("option",{value:a,key:a},c(a),9,H)),64))],40,G),[[j,s.qty]]),e("span",J,c(s.product.unit),1)])])]),e("td",null," $ "+c(s.product.price),1),e("td",K," $ "+c(s.product.price*s.qty),1)]))),128)):U("",!0)]),e("tfoot",null,[e("tr",null,[Q,e("td",R,"$ "+c(l.cart.total),1)])])])):(r(),i("div",W,[X,n(k,{to:"/products",class:"btn btn-danger btn-lg"},{default:y(()=>[x("快來逛逛")]),_:1})]))]),e("div",Y,[n(C,{ref:"form",class:"col-md-6",onSubmit:m.createOrder},{default:y(({errors:s})=>[e("div",Z,[$,n(u,{id:"email",name:"email",type:"email",class:f(["form-control",{"is-invalid":s.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:l.form.user.email,"onUpdate:modelValue":t[1]||(t[1]=a=>l.form.user.email=a)},null,8,["class","modelValue"]),n(b,{name:"email",class:"invalid-feedback"})]),e("div",ee,[te,n(u,{id:"name",name:"姓名",type:"text",class:f(["form-control",{"is-invalid":s.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:l.form.user.name,"onUpdate:modelValue":t[2]||(t[2]=a=>l.form.user.name=a)},null,8,["class","modelValue"]),n(b,{name:"姓名",class:"invalid-feedback"})]),e("div",se,[le,n(u,{id:"tel",name:"電話",type:"tel",class:f(["form-control",{"is-invalid":s.電話}]),placeholder:"請輸入電話",rules:"required|min:8|integer",modelValue:l.form.user.tel,"onUpdate:modelValue":t[3]||(t[3]=a=>l.form.user.tel=a)},null,8,["class","modelValue"]),n(b,{name:"電話",class:"invalid-feedback"})]),e("div",ae,[oe,n(u,{id:"address",name:"地址",type:"text",class:f(["form-control",{"is-invalid":s.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:l.form.user.address,"onUpdate:modelValue":t[4]||(t[4]=a=>l.form.user.address=a)},null,8,["class","modelValue"]),n(b,{name:"地址",class:"invalid-feedback"})]),e("div",ne,[de,n(u,{id:"message",name:"留言",class:"form-control",cols:"30",rows:"10",modelValue:l.form.message,"onUpdate:modelValue":t[5]||(t[5]=a=>l.form.message=a),as:"textarea"},null,8,["modelValue"])]),e("div",re,[e("button",{type:"submit",class:"btn btn-danger",disabled:l.cart.carts.length===0},"送出訂單",8,ie)])]),_:1},8,["onSubmit"])])],64)}const ue=w(B,[["render",ce]]);export{ue as default};
